select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas force index(idx_time_lat_lon) where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas force index(idx_time_lat_lon) where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas force index(idx_time_lat_lon) where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas force index(idx_time_lat_lon) WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas force index(idx_time_lat_lon) where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas force index(idx_time_lat_lon) where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
