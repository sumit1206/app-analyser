select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575397801000 AND 1575484199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, act_time)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, extract(day from ts) as day, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1576002601000 AND 1576088999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575829801000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%jio%'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select * from (select call_no, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop, max_sl_no, pci, cell_id from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, max(sl_no) max_sl_no, string_agg(DISTINCT psc_pci::varchar, ',') as pci, string_agg(DISTINCT cell_id::varchar, ',') as cell_id from black_box_datas where call_no > 0 and call_state > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 or call_drop = 1
select call_no, act_time + 37800 * INTERVAL '1 second' as ts, rsrp, rsrq, sinr, psc_pci pci, cell_id from black_box_datas where sl_no in (469026,467165,472207,475320,481467,480275,480585,483774,487141,487206,487291,487308,487332,487353,487375,487397,487406,497386,508890,509419)
select call_no, mute_no, sum(mute_of)/1000 mute_duration, max(act_time+ 37800 * INTERVAL '1 second') filter (where mute_on > 0) as ts, avg(rsrp) rsrp, avg(sinr) sinr, avg(rsrq) rsrq, string_agg(DISTINCT psc_pci::varchar, ',') as pci, string_agg(DISTINCT cell_id::varchar, ',') as cell_id from black_box_datas  where is_mute = 1 and mute_no > 0 and mute_of > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575225001000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, mute_no order by ts
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') )tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(hour from act_time + 37800 * INTERVAL '1 second') as hour from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select extract(hour from act_time + 37800 * INTERVAL '1 second') as hour, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, act_time)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, extract(day from ts) as day, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') )tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') )tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, extract(day from ts) as day, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, act_time)tbl)tbl2 where call_block = 1 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') )tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, act_time)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, extract(day from ts) as day, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') )tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new  where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, extract(day from ts) as day, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') as ts from black_box_datas_new  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, act_time)tbl)tbl2 where call_block = 1 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, extract(day from ts) as day, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration, min(act_time + 37800 * INTERVAL '1 second') filter (where call_state > 0) as ts from black_box_datas_new where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select * from (select act_time as ts, rsrp, rsrq, sinr, psc_pci pci, cell_id, call_type, case when call_state = 2 and lead(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where is_call = 1 and call_type in (1,2)
select call_no, mute_no, sum(mute_of)/1000 mute_duration, max(act_time+ 37800 * INTERVAL '1 second') filter (where mute_on > 0) as ts, avg(rsrp) rsrp, avg(sinr) sinr, avg(rsrq) rsrq, string_agg(DISTINCT psc_pci::varchar, ',') as pci, string_agg(DISTINCT cell_id::varchar, ',') as cell_id from black_box_datas_new  where is_mute = 1 and mute_no > 0 and mute_of > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no, mute_no order by ts
select call_no, mute_no, sum(mute_of)/1000 mute_duration, max(act_time+ 37800 * INTERVAL '1 second') filter (where mute_on > 0) as ts, avg(rsrp) rsrp, avg(sinr) sinr, avg(rsrq) rsrq, string_agg(DISTINCT psc_pci::varchar, ',') as pci, string_agg(DISTINCT cell_id::varchar, ',') as cell_id from black_box_datas_new  where is_mute = 1 and mute_no > 0 and mute_of > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no, mute_no order by ts
select * from (select act_time as ts, rsrp, rsrq, sinr, psc_pci pci, cell_id, call_type, case when call_state = 2 and lead(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1567276199999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where is_call = 1 and call_type in (1,2) order by ts
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select * from (select act_time as ts, rsrp, rsrq, sinr, psc_pci pci, cell_id, call_type, case when call_state = 2 and lead(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where is_call = 1 and call_type in (1,2) order by ts
select call_no, mute_no, sum(mute_of)/1000 mute_duration, max(act_time+ 37800 * INTERVAL '1 second') filter (where mute_on > 0) as ts, avg(rsrp) rsrp, avg(sinr) sinr, avg(rsrq) rsrq, string_agg(DISTINCT psc_pci::varchar, ',') as pci, string_agg(DISTINCT cell_id::varchar, ',') as cell_id from black_box_datas_new  where is_mute = 1 and mute_no > 0 and mute_of > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1569868201000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no, mute_no order by ts
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1567276201000 AND 1569954599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas_new WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, EXTRACT(EPOCH FROM (max(act_time) filter (where call_state > 0) - min(act_time) filter (where call_state > 0))) as call_duration from black_box_datas_new where lower(make) != 'apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%jio%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of::float/1000) min_mute_sec, max(mute_of::float/1000) max_mute_sec, avg(mute_of::float/1000) avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(case when (total_mute_duration >= 0 and total_mute_duration < 2) then 1 else 0 end) AS range_1, sum(case when (total_mute_duration >= 2 and total_mute_duration < 4) then 1 else 0 end) AS range_2, sum(case when (total_mute_duration >= 4 and total_mute_duration < 6) then 1 else 0 end) AS range_3, sum(case when (total_mute_duration >= 6 and total_mute_duration < 8) then 1 else 0 end) AS range_4, sum(case when (total_mute_duration >= 8 and total_mute_duration < 10) then 1 else 0 end) AS range_5, sum(case when (total_mute_duration >= 10 and total_mute_duration < 12) then 1 else 0 end) AS range_6, sum(case when (total_mute_duration >= 12 and total_mute_duration < 14) then 1 else 0 end) AS range_7, sum(case when (total_mute_duration >= 14 and total_mute_duration < 16) then 1 else 0 end) AS range_8, sum(case when (total_mute_duration >= 16) then 1 else 0 end) AS range_9 from (select call_no, sum(mute_of)::float/1000 as total_mute_duration from black_box_datas_new  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as drop_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 2 group by day
select extract(day from act_time + 37800 * INTERVAL '1 second') as day, avg(setup_time)/1000 as avg_cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1 group by day
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select avg(rsrp::double precision) rsrp, avg(sinr::double precision) sinr, sum(mute_of)::float/1000 as mute_duration, mute_no from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)::float/1000 as mute_duration from black_box_datas_new  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and rsrp is not null and sinr is not null AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select sum(case when (cst >= 0 and cst < 2) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_1, sum(case when (cst >= 2 and cst < 4) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_2, sum(case when (cst >= 4 and cst < 6) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_3, sum(case when (cst >= 6 and cst < 8) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_4, sum(case when (cst >= 8 and cst < 10) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_5, sum(case when (cst >= 10 and cst < 12) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_6, sum(case when (cst >= 12 and cst < 14) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_7, sum(case when (cst >= 14 and cst < 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_8, sum(case when (cst >= 16) then 1 else 0 end)::float/count(call_no)::float * 100 AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas_new  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select call_type, sum(is_call) as calls from (select call_type, case when call_state = 2 and lag(call_state) over(order by imei,ts) is null then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type is not null group by call_type
select day, sum(is_call) as block_calls from (select call_type, extract(day from act_time) as day, case when (call_state = 2 and lag(call_state) over(order by imei,ts) is null) then 1 else 0 end as is_call from black_box_datas_new where lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  1 = 1)tbl where call_type = 1 group by day
select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of)/1000 min_mute_sec, max(mute_of)/1000 max_mute_sec, avg(mute_of)/1000 avg_mute_sec from black_box_datas_new WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT case when (mute_on > 0 and bb_id in ('12340','52850')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  1 = 1) then call_no end) as total_calls, extract(day from act_time + 37800 * INTERVAL '1 second') as day from black_box_datas_new  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1564597801000 AND 1572546599999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
