select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and   lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%%'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and   lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575916199999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and   lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%%'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and   lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and   and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%%'  and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and   and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and    and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1577816999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575484201000 AND 1575570599999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select * from (select call_no, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop, max_sl_no, pci, cell_id from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(sl_no) max_sl_no, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 or call_drop = 1
select call_no, FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, RSRP rsrp, RSRQ rsrq, SINR sinr, PSC_PCI pci, CELL_ID cell_id from black_box_datas where sl_no in (258758,258811,259221,259792,259908,259938,261142,261601,261723,261759,261833,261952,261999,262007,262318,265788,267605,267697,269735,271408,271457,271641,271735,271827,271919,272007,272099,272191,274107,274483,275692,275826,275958,276193,276380,276482,276666,276898,277897,278054,278281,278353,278534,279391,281504,281738,281819,283932,288142,288186,288234,288281,288744,288798,294221,294365,294907,331631,331640,332062,332479,332897,333318,333748,334930,335349,335765,336189,336608,337025,337444,337862,338290,338709,339133,339549,339964,340386,340808,341227,341646,342064,342484,342901,343319,343733,344153,344301,344670,345089,345413,345892,346309,346733,347147,347567,347985,348165,348608,349027,349445,349862,350279,350694,351111,352214,352633,353052,353468,353886,354313,354735,355152,355574,355996,356420,356835,357074,357341,357802,358569,358988,359411,359828,360247,360663,361022,361042,361048,361057,361063,361068,361074,361080,361094,361101,361108,361115,361121,361126,361132,361149,361155,361160,361168,361174,361180,361185,361197,361213,361218,361224,361645,362063,362480,362897,363317,363735,364158,364575,364995,365093,365165,365583,366002,366425,366850,367269,367688,368109,368525,368942,369360,369776,370191,370610,371029,371446,371867,372284,372699,286620,287481,287730,287784,293207,301411,303845,304644,312091,315946,321282,322043,324030,329341,329351,329363,329371,329396,329398,329400,329423,329425,329429,329455,329468,329476,329480,329482,331591,462139,462601,463028,514432,515282,524003,522978,536519,537185,534496,540306,552311,469026,467165,472207,475320,481467,480275,480585,483774,487141,487206,487291,487308,487332,487353,487406,497386,508890,509419,771151,771759,771766,772287,772381,772387,773817,774298,783876,783863,797544,803890,810487,793692,795556,732182,732282,732288,734119,734167,734193,736284,739094,739495,744118,746373,752598,758710,760171,764422,765385,766860,770762,754990,755540,822173,831838,811499,821152,866380,866549,866713,867362,867461,867909,869250,869406,869547,871433,871489,871984,872018,877998,879467,879841,879855,880831,869505,870560,870641,870728,871294,873674,874283,876508,885938,886772,896185,898122,902497,905141,905618,905746,888197,888725,896566,897862,901751,904312,904789,904916,904945,910865,911621,912678,912729,913076,913265,914599,1046584,1049857,1041305,1046509,1047195,1049882,1051934,1077829,1080534,1067400,1096082,1100265,1105572,1105750,1107371,1103347,1109559,1110636,1110827,1112639,1119516,1119523,1127641,1129670,1129673,1131499,1119691,1119878,1126361,1128980,1132012,1132027,1132029,1135300)
select call_no, mute_no, sum(MUTE_OF)/1000 mute_duration, FROM_UNIXTIME(SUBSTR(max(MUTE_ON), 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, avg(RSRP) rsrp, avg(SINR) sinr, avg(RSRQ) rsrq, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where is_mute = 1 and mute_no > 0 and MUTE_OF > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no, mute_no order by ts
select call_no, file_name from (select call_no, sum(voice_files_id) voice_files_id from black_box_datas  where voice_files_id > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl inner join voice_files on (voice_files.id = tbl.voice_files_id)
select * from (select call_no, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop, max_sl_no, pci, cell_id from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(sl_no) max_sl_no, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 or call_drop = 1
select call_no, FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, RSRP rsrp, RSRQ rsrq, SINR sinr, PSC_PCI pci, CELL_ID cell_id from black_box_datas where sl_no in (1119516,1119523,1127641,1129670,1129673,1131499)
select call_no, mute_no, sum(MUTE_OF)/1000 mute_duration, FROM_UNIXTIME(SUBSTR(max(MUTE_ON), 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, avg(RSRP) rsrp, avg(SINR) sinr, avg(RSRQ) rsrq, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where is_mute = 1 and mute_no > 0 and MUTE_OF > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no, mute_no order by ts
select * from (select call_no, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop, max_sl_no, pci, cell_id from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(sl_no) max_sl_no, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 or call_drop = 1
select call_no, FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, RSRP rsrp, RSRQ rsrq, SINR sinr, PSC_PCI pci, CELL_ID cell_id from black_box_datas where sl_no in (258758,258811,259221,259792,259908,259938,261142,261601,261723,261759,261833,261952,261999,262007,262318,265788,267605,267697,269735,271408,271457,271641,271735,271827,271919,272007,272099,272191,274107,274483,275692,275826,275958,276193,276380,276482,276666,276898,277897,278054,278281,278353,278534,279391,281504,281738,281819,283932,288142,288186,288234,288281,288744,288798,294221,294365,294907,331631,331640,332062,332479,332897,333318,333748,334930,335349,335765,336189,336608,337025,337444,337862,338290,338709,339133,339549,339964,340386,340808,341227,341646,342064,342484,342901,343319,343733,344153,344301,344670,345089,345413,345892,346309,346733,347147,347567,347985,348165,348608,349027,349445,349862,350279,350694,351111,352214,352633,353052,353468,353886,354313,354735,355152,355574,355996,356420,356835,357074,357341,357802,358569,358988,359411,359828,360247,360663,361022,361042,361048,361057,361063,361068,361074,361080,361094,361101,361108,361115,361121,361126,361132,361149,361155,361160,361168,361174,361180,361185,361197,361213,361218,361224,361645,362063,362480,362897,363317,363735,364158,364575,364995,365093,365165,365583,366002,366425,366850,367269,367688,368109,368525,368942,369360,369776,370191,370610,371029,371446,371867,372284,372699,286620,287481,287730,287784,293207,301411,303845,304644,312091,315946,321282,322043,324030,329341,329351,329363,329371,329396,329398,329400,329423,329425,329429,329455,329468,329476,329480,329482,331591,462139,462601,463028,514432,515282,524003,522978,536519,537185,534496,540306,552311,469026,467165,472207,475320,481467,480275,480585,483774,487141,487206,487291,487308,487332,487353,487406,497386,508890,509419,771151,771759,771766,772287,772381,772387,773817,774298,783876,783863,797544,803890,810487,793692,795556,732182,732282,732288,734119,734167,734193,736284,739094,739495,744118,746373,752598,758710,760171,764422,765385,766860,770762,754990,755540,822173,831838,811499,821152,866380,866549,866713,867362,867461,867909,869250,869406,869547,871433,871489,871984,872018,877998,879467,879841,879855,880831,869505,870560,870641,870728,871294,873674,874283,876508,885938,886772,896185,898122,902497,905141,905618,905746,888197,888725,896566,897862,901751,904312,904789,904916,904945,910865,911621,912678,912729,913076,913265,914599,1046584,1049857,1041305,1046509,1047195,1049882,1051934,1077829,1080534,1067400,1096082,1100265,1105572,1105750,1107371,1103347,1109559,1110636,1110827,1112639,1119516,1119523,1127641,1129670,1129673,1131499,1119691,1119878,1126361,1128980,1132012,1132027,1132029,1135300)
select call_no, mute_no, sum(MUTE_OF)/1000 mute_duration, FROM_UNIXTIME(SUBSTR(max(MUTE_ON), 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, avg(RSRP) rsrp, avg(SINR) sinr, avg(RSRQ) rsrq, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where is_mute = 1 and mute_no > 0 and MUTE_OF > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no, mute_no order by ts
select call_no, file_name from (select call_no, sum(voice_files_id) voice_files_id from black_box_datas  where voice_files_id > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl inner join voice_files on (voice_files.id = tbl.voice_files_id)
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select * from (select call_no, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop, max_sl_no, pci, cell_id from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(sl_no) max_sl_no, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 or call_drop = 1
select call_no, FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, RSRP rsrp, RSRQ rsrq, SINR sinr, PSC_PCI pci, CELL_ID cell_id from black_box_datas where sl_no in (258758,258811,259221,259792,259908,259938,261142,261601,261723,261759,261833,261952,261999,262007,262318,265788,267605,267697,269735,271408,271457,271641,271735,271827,271919,272007,272099,272191,274107,274483,275692,275826,275958,276193,276380,276482,276666,276898,277897,278054,278281,278353,278534,279391,281504,281738,281819,283932,288142,288186,288234,288281,288744,288798,294221,294365,294907,331631,331640,332062,332479,332897,333318,333748,334930,335349,335765,336189,336608,337025,337444,337862,338290,338709,339133,339549,339964,340386,340808,341227,341646,342064,342484,342901,343319,343733,344153,344301,344670,345089,345413,345892,346309,346733,347147,347567,347985,348165,348608,349027,349445,349862,350279,350694,351111,352214,352633,353052,353468,353886,354313,354735,355152,355574,355996,356420,356835,357074,357341,357802,358569,358988,359411,359828,360247,360663,361022,361042,361048,361057,361063,361068,361074,361080,361094,361101,361108,361115,361121,361126,361132,361149,361155,361160,361168,361174,361180,361185,361197,361213,361218,361224,361645,362063,362480,362897,363317,363735,364158,364575,364995,365093,365165,365583,366002,366425,366850,367269,367688,368109,368525,368942,369360,369776,370191,370610,371029,371446,371867,372284,372699,286620,287481,287730,287784,293207,301411,303845,304644,312091,315946,321282,322043,324030,329341,329351,329363,329371,329396,329398,329400,329423,329425,329429,329455,329468,329476,329480,329482,331591,462139,462601,463028,514432,515282,524003,522978,536519,537185,534496,540306,552311,469026,467165,472207,475320,481467,480275,480585,483774,487141,487206,487291,487308,487332,487353,487406,497386,508890,509419,771151,771759,771766,772287,772381,772387,773817,774298,783876,783863,797544,803890,810487,793692,795556,732182,732282,732288,734119,734167,734193,736284,739094,739495,744118,746373,752598,758710,760171,764422,765385,766860,770762,754990,755540,822173,831838,811499,821152,866380,866549,866713,867362,867461,867909,869250,869406,869547,871433,871489,871984,872018,877998,879467,879841,879855,880831,869505,870560,870641,870728,871294,873674,874283,876508,885938,886772,896185,898122,902497,905141,905618,905746,888197,888725,896566,897862,901751,904312,904789,904916,904945,910865,911621,912678,912729,913076,913265,914599,1046584,1049857,1041305,1046509,1047195,1049882,1051934,1077829,1080534,1067400,1096082,1100265,1105572,1105750,1107371,1103347,1109559,1110636,1110827,1112639,1119516,1119523,1127641,1129670,1129673,1131499,1119691,1119878,1126361,1128980,1132012,1132027,1132029,1135300)
select call_no, mute_no, sum(MUTE_OF)/1000 mute_duration, FROM_UNIXTIME(SUBSTR(max(MUTE_ON), 1, 10)+19800, '%Y-%m-%d %H:%i:%s') ts, avg(RSRP) rsrp, avg(SINR) sinr, avg(RSRQ) rsrq, GROUP_CONCAT(distinct PSC_PCI SEPARATOR ',') pci, GROUP_CONCAT(distinct CELL_ID SEPARATOR ',') cell_id from black_box_datas  where is_mute = 1 and mute_no > 0 and MUTE_OF > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no, mute_no order by ts
select call_no, file_name from (select call_no, sum(voice_files_id) voice_files_id from black_box_datas  where voice_files_id > 0 and lower(SPN) like '%%' AND lower(MAKE) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl inner join voice_files on (voice_files.id = tbl.voice_files_id)
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, day from (select call_no, day(ts) day, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by day
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, day(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) day from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by day
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, day from (select call_no, day(ts) day, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575138601000 AND 1575311399999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by day
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6666670) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2166670) ) + sin ( radians(28.6666670) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration from black_box_datas  where MAKE != 'Apple' and call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(MUTE_OF)/1000 as total_mute_duration from black_box_datas  where MUTE_OF > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE CALL_STATE = 2 AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct CALL_STATE SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(TIMESTAMP), 1, 10)), FROM_UNIXTIME(SUBSTR(min(TIMESTAMP), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and CALL_STATE > 0 and lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('1234','5285') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(MUTE_OF/1000) min_mute_sec, max(MUTE_OF/1000) max_mute_sec, avg(MUTE_OF/1000) avg_mute_sec from black_box_datas WHERE MUTE_ON > 0 and BB_ID in ('12340','52850') AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(MUTE_ON > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(CALL_STATE > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(TIMESTAMP, 1, 10)+19800)) hour from black_box_datas  WHERE lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(MUTE_OF)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(MUTE_OF)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(SPN) like '%airtel%' AND lower(MAKE) != 'apple'  AND (TIMESTAMP BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and BB_ID in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and BB_ID in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and BB_ID in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and BB_ID in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and BB_ID in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and BB_ID in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and BB_ID in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and BB_ID in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and BB_ID in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and BB_ID in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and BB_ID in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  BB_ID in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (timestamp BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  BB_ID in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and   lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%%' AND lower(make) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%%'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%%' AND lower(make) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%%' AND lower(make) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%%' AND lower(make) != 'apple'  and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) hour from black_box_datas  WHERE    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) hour from black_box_datas  WHERE    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and   lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(timestamp), 1, 10)), FROM_UNIXTIME(SUBSTR(min(timestamp), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(timestamp, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and    lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_drop from (select call_no, sum(setup_time::double precision) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time::double precision) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time::double precision) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, TIME_TO_SEC(TIMEDIFF(FROM_UNIXTIME(SUBSTR(max(ts), 1, 10)), FROM_UNIXTIME(SUBSTR(min(ts), 1, 10)))) call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, if((setup_time is null or setup_time <= 0) and call_duration < 10, 1, 0) as call_block, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, sum(setup_time) setup_time, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, GROUP_CONCAT(distinct call_state SEPARATOR ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as  hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, hour(ts) hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_drop = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as  hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, if(call_duration > 10 and call_duration < 180, 1, 0) as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_drop = 1 group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, max(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, hour(ts) hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT IF(mute_on > 0 and bb_id in ('1234','5285'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285') else call_no end as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') ) then call_no end as total_calls, extract(hour from act_time) as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') )) then call_no end) as total_calls, extract(hour from act_time) as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select min(total_mute_duration) min_mute_duration, max(total_mute_duration) max_mute_duration, avg(total_mute_duration) avg_mute_duration, sum(IF(total_mute_duration >= 0 and total_mute_duration < 2, 1, 0)) AS range_1, sum(IF(total_mute_duration >= 2 and total_mute_duration < 4, 1, 0)) AS range_2, sum(IF(total_mute_duration >= 4 and total_mute_duration < 6, 1, 0)) AS range_3, sum(IF(total_mute_duration >= 6 and total_mute_duration < 8, 1, 0)) AS range_4, sum(IF(total_mute_duration >= 8 and total_mute_duration < 10, 1, 0)) AS range_5, sum(IF(total_mute_duration >= 10 and total_mute_duration < 12, 1, 0)) AS range_6, sum(IF(total_mute_duration >= 12 and total_mute_duration < 14, 1, 0)) AS range_7, sum(IF(total_mute_duration >= 14 and total_mute_duration < 16, 1, 0)) AS range_8, sum(IF(total_mute_duration >= 16, 1, 0)) AS range_9 from (select call_no, sum(mute_of)/1000 as total_mute_duration from black_box_datas  where mute_of > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select avg(RSRP) RSRP, avg(SINR) SINR, sum(mute_of)/1000 as mute_duration, mute_no from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no
select count(1) as mute_samples, min(mute_duration) min_mute_duration, max(mute_duration) max_mute_duration, avg(mute_duration) avg_mute_duration from (select mute_no, sum(mute_of)/1000 as mute_duration from black_box_datas  where is_mute = 1 and mute_no > 0 and bb_id in ('1234','5285') and RSRP REGEXP '[0-9]' and SINR REGEXP '[0-9]' AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by mute_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select extract(hour from act_time) as hour, avg(setup_time)/1000 as avg_cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by hour
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 and lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) total_calls, sum(call_block) block_calls, sum(call_drop) drop_calls from (select call_no, call_duration, states, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration from black_box_datas  where make != 'Apple' and call_no > 0 and call_state > 0 and lower(spn) like '%airtel%'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state)tbl)tbl2
select count(call_no) drop_calls, hour from (select call_no, extract(hour from ts) as hour, case when (call_duration > 10 and call_duration < 180) then 1 else 0 end as call_drop from (select call_no, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_drop = 1 group by hour
select count(cst) samples, avg(cst)/1000 as avg_cst, min(cst)/1000 min_cst, max(cst)/1000 max_cst from (select call_no, avg(setup_time) as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select FORMAT(sum(IF(cst >= 0 and cst < 2, 1, 0))/count(call_no) * 100, 1) AS range_1, FORMAT(sum(IF(cst >= 2 and cst < 4, 1, 0))/count(call_no) * 100, 1) AS range_2, FORMAT(sum(IF(cst >= 4 and cst < 6, 1, 0))/count(call_no) * 100, 1) AS range_3, FORMAT(sum(IF(cst >= 6 and cst < 8, 1, 0))/count(call_no) * 100, 1) AS range_4, FORMAT(sum(IF(cst >= 8 and cst < 10, 1, 0))/count(call_no) * 100, 1) AS range_5, FORMAT(sum(IF(cst >= 10 and cst < 12, 1, 0))/count(call_no) * 100, 1) AS range_6, FORMAT(sum(IF(cst >= 12 and cst < 14, 1, 0))/count(call_no) * 100, 1) AS range_7, FORMAT(sum(IF(cst >= 14 and cst < 16, 1, 0))/count(call_no) * 100, 1) AS range_8, FORMAT(sum(IF(cst >= 16, 1, 0))/count(call_no) * 100, 1) AS range_9 from (select call_no, avg(setup_time)/1000 as cst from black_box_datas  where setup_time > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by call_no)tbl
select count(distinct call_no) total_calls from black_box_datas WHERE call_state = 2 AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285') 
select count(call_no) block_calls, hour from (select call_no, extract(hour from ts) as hour, case when ((setup_time is null or setup_time <= 0) and call_duration < 10) then 1 else 0 end as call_block from (select call_no, sum(setup_time) setup_time, string_agg(DISTINCT call_state::varchar, ',') states, EXTRACT(EPOCH FROM (case when (call_state > 0) then max(act_time) end - case when (call_state > 0) then min(act_time) end)) as call_duration, act_time as ts from black_box_datas  where call_no > 0 and call_state > 0 and lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 and  bb_id in ('1234','5285')  group by call_no, call_state, act_time)tbl)tbl2 where call_block = 1 group by hour
select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('1234','5285') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 UNION ALL select count(distinct call_no) mute_calls, min(mute_of/1000) min_mute_sec, max(mute_of/1000) max_mute_sec, avg(mute_of/1000) avg_mute_sec from black_box_datas WHERE mute_on > 0 and bb_id in ('12340','52850') AND lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561
select count(DISTINCT case when (mute_on > 0 and bb_id in ('1234','5285')) then call_no end) as mute_calls, count(DISTINCT case when (call_state > 0 and  bb_id in ('1234','5285') )) then call_no end) as total_calls, extract(hour from act_time) as hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
select count(DISTINCT IF(mute_on > 0 and bb_id in ('12340','52850'), call_no, NULL)) as mute_calls, count(DISTINCT IF(call_state > 0 and  bb_id in ('1234','5285') , call_no, NULL)) as total_calls, hour(FROM_UNIXTIME(SUBSTR(ts, 1, 10)+19800)) hour from black_box_datas  WHERE lower(spn) like '%airtel%' AND lower(make) != 'apple'  AND (ts BETWEEN 1575570601000 AND 1575656999999) and (3959 * acos (cos ( radians(28.6) ) * cos( radians( lat ) ) * cos( radians( lon ) - radians(77.2) ) + sin ( radians(28.6) ) * sin( radians( lat ) ))) < 30 AND  lat >= 6.5546079 and lat <= 35.6745457 and lon >= 68.1113787 and lon <= 97.395561 group by hour
